\documentclass[final,5p,times,twocolumn,authoryear]{elsarticle}

\usepackage{amssymb}
\usepackage{lipsum}
\usepackage{amsthm}
\usepackage{amsmath}
\usepackage[utf8]{inputenc}
\usepackage{lineno}
\usepackage{tabularx}

\newcommand{\pd}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\pdd}[2]{\frac{\partial^2 #1}{\partial #2^2}}

\journal{Graduate School@UGA}

\begin{document}

\begin{frontmatter}

\title{
\begin{minipage}{0.3\textwidth}
\includegraphics[width=0.9\textwidth]{LEGI-logo.png}
\end{minipage}%
\begin{minipage}{0.4\textwidth}
\centering
\textbf{Simulations of stratified turbulence} \\ \textbf{and comparison with oceanic wave turbulence}
\end{minipage}%
\begin{minipage}{0.3\textwidth}
\flushright
\includegraphics[width=0.9\textwidth]{UGA-logo.png}
\end{minipage}
}

\author[first]{Guillermin Remy}

\begin{abstract}
This study investigates stratified turbulence and its interactions with internal waves using high-resolution Direct Numerical Simulations (DNS). Results reveal an energy cascade following the $k^{-5/3}$ power law, and Richardson number distributions consistent with prior studies.
\end{abstract}

\begin{keyword}
%% keywords here, in the form: keyword \sep keyword, up to a maximum of 6 keywords
Numerical Simulation \sep Fluids Dynamic \sep Turbulence

\end{keyword}

\end{frontmatter}

\section{Introduction}
\label{introduction}

In fluid mechanics, turbulence arises when the Reynolds number, $\mathrm{Re} = UL/\nu \gg 1$, where $U$ and $L$ are the characteristic velocity and length scales of the flow, and $\nu$ is the kinematic viscosity. This condition is typically met in scenarios such as high-speed flows (e.g., jet engine exhaust), large-scale flows (e.g., atmospheric or ocean currents), or in fluids with negligible viscosity, like superfluids. Turbulence is characterised by chaotic, irregular motion that significantly affects the transport of momentum, heat, and mass.

In the context of large-scale climate systems, such as the ocean and atmosphere, turbulence is even more complex due to the additional influence of Earth‚Äôs rotation and the stratification of the fluid‚Äîeither by temperature (in the atmosphere) or density (in the ocean). These factors modify the basic dynamics described by the Navier-Stokes equations. Specifically, stratification leads to the formation of internal waves, which in turn interact with turbulence in intricate ways, driving the transport and mixing processes that are fundamental to climate dynamics.

This project focuses on the effects of density stratification in large-scale flows, particularly how it induces internal wave turbulence. Understanding this phenomenon is crucial because internal waves play a key role in energy transfer within oceans and atmospheres, influencing ocean currents and atmospheric circulation patterns. By studying turbulent flows under stratified conditions, we aim to gain insights into the mechanisms governing large-scale climate dynamics and the energy cascades that drive these systems.

In a first part we will focus on the theory about such flows, we will study the wave in stratified and rotating flows but in our simulation we will only cover the stratified case.

In a second part we will describe the issues faced, how they have been resolved. We will also talk about the simulation parameters.

Finally in the last part we will discuss the results obtained for different simulation. 

\section{Theoretical background}
\subsection{Navier-Stokes Equations}

The governing equations for fluid motion in this study are the Navier-Stokes equations, given by:
\begin{subequations}
\begin{align}
\pd{\rho}{t} + \vec{\nabla} \left( \rho \vec{u} \right) &= 0 \\
\rho \left( \pd{\vec{u}}{t} + \left( \vec{u} \cdot \vec{\nabla} \right) \vec{u} \right) &= - \vec{\nabla} p - \rho g \hat{z} + \mu \Delta \vec{u} - 2 \rho \vec{\Omega} \wedge \vec{u}
\end{align}
\label{eq:NS}
\end{subequations}
where $\rho$ is the fluid density, $\vec{u}$ is the velocity field, $p$ is the pressure, $\mu$ is the dynamic viscosity, $\vec{\Omega}$ is the rotation of the frame of reference and $g$ is the acceleration due to gravity. These equations describe the motion of a viscous fluid, accounting for both inertial and gravitational forces.

\subsection{Dimensionless Numbers}

In the study of fluid mechanics, the Froude number $\mathrm{Fr}$ is a key dimensionless quantity that represents the ratio of inertial forces (advection) to gravitational forces.
\begin{equation*}
	\mathrm{Fr}^2 = U^2 / gH
\end{equation*} 
Here, $U$ is the characteristic velocity, $g$ is gravitational acceleration, and $H$ is the characteristic depth or length scale of the flow. The Froude number is useful in understanding the behaviour of stratified fluids, where gravity plays a significant role in the dynamics.

The Richardson number $Ri$ is a key parameter that characterizes the ratio of buoyancy forces to flow shear forces [\cite{cushman-roisin_introduction_2011}]. This dimensionless number is defined as:
\begin{equation}
Ri = \frac{N^2}{\left(d \bar{u} / dz \right)^2}
\end{equation}

Where $N^2 = -\frac{g}{\rho} \pd{\rho}{z}$ is the Brunt-V√§is√§l√§ frequency [\cite{pedlosky_geophysical_1979}] and $d \bar{u} / dz$ is the vertical velocity gradient.

For rotating flow we can also define the Rossby number as the ratio of the inertial forces and the Coriolis forces
\begin{equation*}
	Ro = \frac{U}{fL}
\end{equation*}
Here, $f$ is the Coriolis parameter $f = 2\Omega$ in the case of a planar frame of reference, if we look at the case of the Earth, we need to take account for the latitude at which the experiment/simulation takes place.

\subsection{Boussinesq Approximation and Inertia-Wave Propagation}

For density stratified fluids, the Boussinesq approximation [\cite{boussinesq_theorie_1897}] is commonly applied, which assumes that density variations are small and only affect the buoyancy force, while the density is constant elsewhere. After applying this approximation to the Navier-Stokes equations and simplifying, we derive the gravity-wave propagation equation:
\begin{equation}
\partial^2_t \vec{u} = \left( N^2 \nabla^2_h \nabla^{-2} \right) \vec{u} \label{eq:Wave Propagation}
\end{equation}
where $\nabla_h$ is the horizontal gradient operator, $\nabla$ is the spatial gradient operator, and $N$ is the Brunt-V√§is√§l√§ frequency. This equation describes the propagation of internal waves in a stratified fluid.

\subsection{Dispersion Relation of Gravity Waves}

The dispersion relation for inertia-gravity waves is given by:
\begin{equation}
\omega^2 = \frac{f^2 k_z^2 + N^2 k_h^2}{k^2} \label{eq:Dispersion relation}
\end{equation}
where $\omega$ is the frequency of the wave, $k_z$ is the vertical wave-vector and $k_h^2 = k_x^2 + k_y^2$ is the horizontal wave-vector. This relation shows that the frequency $\omega_+$ is bounded within the range $\left[ f, N \right]$ and $\omega_-$ between $\left[ N, -f \right]$, where $N$ is the Brunt-V√§is√§l√§ frequency, which determines the stability of stratified fluid systems and $f$ is the Coriolis frequency, which quantifies the rotation of the frame of reference.

\section{Numerical Setup}

\subsection{Computational Tools}

This study leverages \texttt{Fluidsim} [\cite{fluiddyn}], a high-performance computing (HPC) code utilizing pseudo-spectral solvers. \texttt{Fluidsim} is particularly well-suited for simulating fluid dynamics in stratified flows, offering efficient computation for large-scale simulations.

\subsection{Computational Environment}

The simulations are performed on three platforms: 

\begin{itemize}
    \item \textbf{Zen (Mesonet)}: A supercomputer offering ease of use and good computational power for medium-resolution simulations (up to $(256, 256, 64)$). However, it lacks efficient parallelization capabilities for multi-node simulations.
    \item \textbf{GRICAD Cluster (Miniforge3)}: Supports single-node simulations. This will be the primary focus due to the current issues with multi-node setups.
    \item \textbf{GRICAD Cluster (Guix)}: Provides potential for multi-node simulations, which is essential for higher-resolution simulations, but setup and execution currently face technical challenges.
\end{itemize}

\subsection{Challenges Encountered}

Several technical issues have impacted the simulation workflow:

\begin{itemize}
    \item \textbf{GRICAD (Guix):} Initial difficulties arose during configuration, requiring IT support to resolve. While Guix is operational, multi-node simulations using MPI processes are not functioning, limiting the scalability needed for high-resolution simulations.
    \item \textbf{Zen (Mesonet):} While job submission is straightforward, parallel simulations using MPI are not currently working. This restricts computational efficiency, as only sequential simulations are possible at present.
\end{itemize}

Addressing these challenges is essential for performing high-resolution DNS efficiently and should be a priority for future work.

\section{Simulation Parameters}

\subsection{Direct Numerical Simulation (DNS) Requirements}

Direct Numerical Simulations (DNS) demand a high grid resolution that resolves all turbulent scales down to the smallest dissipative structures, characterized by the Kolmogorov length scale $\eta$. This ensures accurate representation of the flow dynamics across the entire range of scales, from large eddies to fine-scale turbulence. 

\subsection{Reynolds Number and Kolmogorov Length Scale}

For different orders of viscosity $n$, the Reynolds number $Re_n$ is given by:
\begin{equation*}
    Re_n = \frac{U L^{n-1}}{\nu_n}
\end{equation*}
where $\nu_n$ is the viscosity of order $n$. For $n=2$, $\nu_2$ corresponds to the standard viscosity term present in the Navier-Stokes equations. For $n>2$, higher-order viscosities are introduced, appearing as additional dissipation terms of the form $\nu_n \nabla^n$. These terms provide additional flexibility in controlling dissipation at small scales.

Using a turbulent scaling of velocity $u(l) = (\varepsilon l)^{1/3}$, we can express the Reynolds number as:
\begin{equation*}
    Re_n(l) = \frac{\varepsilon^{1/3} l^{n - 2/3}}{\nu_n}.
\end{equation*}

The Kolmogorov length scale $\eta_n$ corresponds to the scale where $Re_n(l) = 1$, and is given by:
\begin{equation*}
    \eta_n = \left(\frac{\nu_n}{\varepsilon^{1/3}}\right)^{1 / (n - 2/3)}.
\end{equation*}

\subsection{DNS Feasibility}

To perform DNS, we must ensure the condition $k_{\text{max}} \eta > 1$, where $k_{\text{max}}$ is the largest resolved wavenumber:
\begin{equation*}
    k_{\text{max}} = \frac{2\pi}{L_x} \frac{n_x}{2}.
\end{equation*}

Assuming we want to have $\nu_2 = 10^{-6}$ and $\varepsilon = 1$, the Kolmogorov length scale $\eta$ is calculated as $\eta = 10^{-4.5}$. This leads to a required horizontal resolution of approximately $n_x = 30198$ grid points, which is computationally unfeasible for this project.

We then need to find the viscosity required to have a DNS using 
\begin{equation*}
	\nu = C \left( \frac{L_x}{n_x} \right)^{4/3}  \varepsilon^{1/3}
\end{equation*}

Where $C \sim 1$. We then can express the maximum initial Reynolds number we can inject in order to have a DNS with a maximum initial velocity $u_i$ at a length of $1.0$
\begin{equation*}
	Re_i = \frac{u_i n_x^{4/3}}{3^{4/3} \varepsilon^{1/3}}
\end{equation*}




\section{Simulation results}
\subsection{Isotropic test case}
First we will perform some simulation up to $(256 \times 256 \times 64)$ for a setup without stratification 
\subsection{Stratified dataset}

We will perform a set of simulation 

\begin{table}[h]
\centering
\renewcommand{\arraystretch}{1.5}
\begin{tabularx}{0.48\textwidth}{l c c c c c} 
 \hline
 Name & Re $\left(\times 10^3\right)$ & Fr $\left(\times 10^{-3}\right)$ & Nz & T & $k_{max} \eta$ \\
 \hline \hline
 ns3d-1 & 0.375 & 0.001 & $64$ & & 3.14 \\
 ns3d-5 & 0.375 & 0.002 & $64$ & & 3.14 \\
 ns3d-10 & 0.375 & 0.0001 & $64$ & & 3.14 \\ 
 \hline
\end{tabularx}
\caption{Simulation parameters for the stratified dataset - T is the time to compute the simulation}
\label{Table1}
\end{table}

\section{Discussion}

As part of a master‚Äôs project, this study has focused on simulating stratified turbulence under controlled conditions, providing a foundation for understanding key dynamics. While the results highlight the expected anisotropy and energy cascade in stratified flows, the scope was limited by computational resources and simulation duration. 

Future work could extend this study by exploring a broader range of Brunt-V√§is√§l√§ frequencies, increasing the resolution of the simulation or incorporating rotational effects to simulate more realistic geophysical scenarios. Improving parallelization on HPC clusters would also enable higher-resolution simulations, allowing for more detailed analysis of small-scale dynamics and wave-turbulence interactions.

\section{Summary and conclusions}

\bibliographystyle{elsarticle-harv} 
\bibliography{references.bib}


\end{document}

\endinput